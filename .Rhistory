suppressMessages(library(RMySQL))
con <- dbConnect(RMySQL::MySQL(),
user="root", password="RM333",
dbname="PEGH", host="localhost")
con <- dbConnect(RMySQL::MySQL(),
user="root", password="RM333",
dbname="PEGH", host="localhost")
invisible(dbSendQuery(con,sqlquery))
invisible(dbDisconnect(con))
invisible(dbDisconnect(con))
con <- dbConnect(RMySQL::MySQL(),
user="root", password="RM333",
dbname="PEGH", host="localhost")
suppressMessages(library(RMySQL))
# Retrieve data from MySQL:
con <- dbConnect(RMySQL::MySQL(),
user="root", password="RM333",
dbname="PEGH", host="localhost")
data <- dbReadTable(con,"Intrain_STL003")
data
cor.test(data$H3K27ac_Theta,data$H3K27ac_Var)
cor.test(data$H3K27ac_Pi,data$H3K27ac_Var)
cor.test(data$Bisulfite-Seq_Pi,data$Bisulfite-Seq_Var)
head(data)
cor.test(data$Bisulfite.Seq_Pi,data$Bisulfite.Seq_Var)
epi.data <- data
con <- dbConnect(RMySQL::MySQL(),
user="root", password="RM333",
dbname="PEGH", host="localhost")
gen.data <- dbReadTable(con,"Genomics_Pilot")
cor(gen.data$S,epi.data$Bisulfite.Seq_Pi)
gen.data$S
gen.data[,2:3] <- apply(gen.data[,2:3],2,as.numeric) # Make the variable numeric
cor(gen.data$S,epi.data$Bisulfite.Seq_Pi)
gen.data
gent.data$S
gen.data$S
gen.data[,2:3] <- apply(gen.data[,2:3],2,as.numeric) # Make the variable numeric
gen.data[,2:3] <- apply(gen.data[,2:3],2,as.numeric) # Make the variable numeric
gen.data$S
head(gen.data)
gen.data$SPi
gent.data$Pi
gen.data$Pi
epi.data
epi.data$Bisulfite.Seq_Pi
gen.data <- dbReadTable(con,"Genomics_Pilot")
gen.data[,2:3] <- apply(gen.data[,2:3],2,as.numeric) # Make the variable numeric
gen.data$Pi
cor(gen.data$S,epi.data$Bisulfite.Seq_Pi)
cor.test(gen.data$S,epi.data$Bisulfite.Seq_Pi)
cor.test(gen.data$Pi,epi.data$Bisulfite.Seq_Pi)
cor.test(gen.data$Pi,epi.data$H3K27me3_Pi)
cor.test(gen.data$Pi,epi.data$H3K27ac_Pi)
cor.test(gen.data$Pi,epi.data$H3K27me3_Var)
cor.test(gen.data$Pi,epi.data$H3K4me1_Var)
cor.test(gen.data$Pi,epi.data$H3K4me1_Pi)
qplot(gen.data$Pi,epi.data$H3K4me1_Var)
library(ggplot2)
qplot(gen.data$Pi,epi.data$H3K4me1_Var)
qplot(gen.data$Pi,epi.data$H3K27ac_Pi)
qplot(gen.data$Pi,epi.data$H3K27me3_Var)
qplot(gen.data$Pi,epi.data$H3K36me3_Var)
cor(gen.data$Pi,epi.data$H3K36me3_Var)
cor(gen.data$Pi,epi.data$H3K36me3_Pi)
qplot(gen.data$Pi,epi.data$H3K36me3_Pi)
qplot(gen.data$Pi,epi.data$Level)
qplot(gen.data$Pi,epi.data$Bisulfite.Seq_Level)
cor(gen.data$Pi,epi.data$Bisulfite.Seq_Level)
cor(gen.data$Pi,epi.data$Bisulfite.Seq_Theta)
cor(gen.data$Pi,epi.data$Bisulfite.Seq_LevelVar)
cor(epi.data$Bisulfite.Seq_Pi,epi.data$Bisulfite.Seq_Theta)
qplot(epi.data$Bisulfite.Seq_Pi,epi.data$Bisulfite.Seq_Theta)
bis.data <- epi.data[,1:7]
head(bis.data)
bis.data <- epi.data[,1:9]
bis.data
bis.data$Bisulfite.Seq_S == 0
bis.data[bis.data$Bisulfite.Seq_S == 0,]
head(bis.data[bis.data$Bisulfite.Seq_S == 0,])
head(gene.data[bis.data$Bisulfite.Seq_S == 0,])
head(gen.data[bis.data$Bisulfite.Seq_S == 0,])
head(gen.data[bis.data$Bisulfite.Seq_S > 9,])
head(gen.data[bis.data$Bisulfite.Seq_S > 0.4 & bis.data$Bisulfite.Seq_S < 0.8,])
head(gen.data[bis.data$Bisulfite.Seq_S > 0.1,])
head(gen.data[bis.data$Bisulfite.Seq_S > 0.2,])
mean(gen.data[bis.data$Bisulfite.Seq_S > 0.2,]$Pi)
mean(gen.data[bis.data$Bisulfite.Seq_S == 0,]$Pi)
mean(gen.data[bis.data$Bisulfite.Seq_S > 0.9,]$Pi)
mean(gen.data[bis.data$Bisulfite.Seq_S > 0.8,]$Pi)
mean(gen.data[bis.data$Bisulfite.Seq_S > 0.7,]$Pi)
mean(gen.data[bis.data$Bisulfite.Seq_S > 0.6,]$Pi)
mean(gen.data[bis.data$Bisulfite.Seq_S > 0.5,]$Pi)
mean(gen.data[bis.data$Bisulfite.Seq_S > 0.1,]$Pi)
mean(gen.data[bis.data$Bisulfite.Seq_S == 0.1,]$Pi)
gen.data[bis.data$Bisulfite.Seq_S == 0.1,
gen.data[bis.data$Bisulfite.Seq_S == 0.1
gen.data[bis.data$Bisulfite.Seq_S == 0.1]
bis.data$Bisulfite.Seq_S == 0.1
bis.data$Bisulfite.Seq_S == 0
table(bis.data$Bisulfite.Seq_S)
table(bis.data$Bisulfite.Seq_Level)
hist(bis.data$Bisulfite.Seq_Level)
hist(epi.data$H3K27ac_Level)
hist(epi.data$H3K36me3_Level)
genes <- genes(TxDb.Hsapiens.UCSC.hg19.knownGene) # Genes in human genome
library(BSgenome.Hsapiens.UCSC.hg19)
genes <- genes(TxDb.Hsapiens.UCSC.hg19.knownGene) # Genes in human genome
genes <- genes[seqnames(genes) == "chr22"] # Genes in chr22
genes <- genes(TxDb.Hsapiens.UCSC.hg19.knownGene) # Genes in human genome
if (suppressMessages(!require("Repitools"))) {
print ("The 'Repitools' package is missing and will be installed")
biocLite("Repitools")
}
if (suppressMessages(!require("TxDb.Hsapiens.UCSC.hg19.knownGene"))) {
print ("The 'TxDb hg19' package is missing and will be installed")
biocLite("TxDb.Hsapiens.UCSC.hg19.knownGene")
}
genes <- genes(TxDb.Hsapiens.UCSC.hg19.knownGene) # Genes in human genome
genes <- genes[seqnames(genes) == "chr22"] # Genes in chr22
genes
metadata(genes)
genes <- genes(TxDb.Hsapiens.UCSC.hg19.knownGene) # Genes in human genome
genes
genes <- genes(TxDb.Hsapiens.UCSC.hg19.knownGene) # Genes in human genome
genes <- genes[seqnames(genes) == "chr22"] # Genes in chr22
genes <- sort(genes,by=~seqnames + start + end) # Or just sort
genes
